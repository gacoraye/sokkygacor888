<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Slot 5x4</title>
<style>
html, body {
  margin: 0;
  padding: 0;
  overflow: hidden; /* BLOCK SCROLL */
  height: 100%;
  background:#111;
  color:#fff;
  font-family:Arial,sans-serif;
  display:flex;
  justify-content:center;
  align-items:center;
}

.game-box{
  background:#1b1b1b;
  border-radius:16px;
  padding:16px;
  width:520px;       /* FIXED WIDTH */
  box-sizing:border-box;
  text-align:center;
}
h1{margin:0 0 10px}
.slot{
  display:grid;
  grid-template-columns:repeat(5,1fr);
  gap:8px;
  margin:10px 0;
  position:relative;
  width:500px;       /* FIXED WIDTH */
}
.reel{
  width:100%;
  height:260px;
  overflow:hidden;
  background:#222;
  border-radius:12px;
  position:relative;
}
.reel.hover{ box-shadow:0 0 20px 6px #00ff99; }
.cell{
  height:65px;
  font-size:32px;
  display:flex;
  align-items:center;
  justify-content:center;
  transition: transform 0.5s linear;
}
.row-highlight{
  position:absolute;
  top:0;
  height:65px;
  border:2px solid #00ff99;
  border-radius:8px;
  pointer-events:none;
  box-sizing:border-box;
  opacity:0.8;
}
.info{margin-top:6px}

/* BARIS 1: saldo kiri, taruhan kanan */
.row1{
  display:flex;
  justify-content:space-between;
  align-items:center;
  margin-bottom:4px;
}
.balance-box{ min-width:150px; text-align:left; }
.bet-box{
  display:flex;
  gap:6px;
}
.bet-buttons{
  display:flex;
  gap:6px;
}
.bet-buttons button{
  width:60px;       /* FIXED WIDTH */
  height:38px;      /* FIXED HEIGHT */
  padding:0;
  font-size:14px;
  border:2px solid #00ff99;
  border-radius:8px;
  background:#111;
  color:#fff;
  cursor:pointer;
  font-weight:bold;
}
.bet-buttons .active{ background:#00ff99; color:#000; }

/* Tombol Auto Spin / multiplier */
.auto-spin-btn{
  width:60px;      /* FIXED WIDTH */
  height:38px;     /* FIXED HEIGHT */
  padding:0;
  border:2px solid #00ff99;
  border-radius:4px;
  background:#111;
  color:#fff;
  font-size:14px;
  cursor:pointer;
  font-weight:bold;
}
.auto-spin-btn.disabled{ background:#555; cursor:not-allowed; }

/* BARIS 2: ON Free Spin kiri, SPIN kanan */
.row2{
  display:flex;
  justify-content:space-between;
  align-items:center;
  margin-top:6px;
}
.free-spin-display{
  display:flex;
  align-items:center;
  gap:6px;
  margin-top:-25px;
}
.free-spin-btn{
  width:60px;       /* FIXED WIDTH */
  height:32px;      /* FIXED HEIGHT */
  padding:0;
  border:2px solid #00ff99;
  border-radius:4px;
  background:#111;
  color:#fff;
  font-size:14px;
  cursor:pointer;
  font-weight:bold;
}
.free-spin-btn.active{ background:#00ff99; color:#000; }

.spin-btn{
  padding:12px 0;
  font-size:20px;
  font-weight:bold;
  border:none;
  border-radius:12px;
  background:gold;
  cursor:pointer;
  width:120px;      /* FIXED WIDTH */
  min-width:120px;
}
.spin-btn.disabled{ background:red; cursor:not-allowed; }
</style>
</head>

<body>

<audio id="spinSound" src="slotspin.mp3" preload="auto"></audio>

<div class="game-box">
<h1>üé∞ SLOT 5 √ó 4</h1>
<div class="slot" id="slot"></div>

<div class="info">
  <div class="row1">
    <div class="balance-box">
      üí∞ <span id="balance">Rp 10.000</span>
      <span id="winFloat" class="win-float"></span>
    </div>
    <div class="bet-box">
      <button id="autoSpinBtn" class="auto-spin-btn" onclick="cycleAutoSpin()">x1</button>
      <div class="bet-buttons">
        <button onclick="setBet(100)">100</button>
        <button onclick="setBet(400)">400</button>
        <button onclick="setBet(1000)" class="active">1k</button>
        <button onclick="setBet(20000)">20k</button>
      </div>
    </div>
  </div>

  <div class="row2">
    <div class="free-spin-display">
      <button id="toggleFreeSpin" class="free-spin-btn active" onclick="toggleFreeSpin()">ON</button>
      <span id="freeSpinDisplay">Free Spins: 0</span>
    </div>
    <button id="spinBtn" class="spin-btn" onclick="spinAuto()">SPIN</button>
  </div>

</div>

<script>
const spinSound = document.getElementById("spinSound");
spinSound.volume = 0.4;
let audioUnlocked=false;

const SPIN_DURATION = 600;
const rows=4, cols=5, cellH=65;
const symbols=["üçí","üçã","üçâ","üîî","üíé","üÉè","‚≠ê"];
let balance=10000, bet=1000, stops=new Array(cols).fill(0), freeSpins=0;
let useFreeSpin=true, autoSpinModes=[1,4,9], autoSpinIndex=0, isAutoSpinning=false;

const slot=document.getElementById("slot");
const reels=[];
const winFloat=document.getElementById("winFloat");
const betButtons=document.querySelectorAll(".bet-buttons button");
const autoSpinBtn=document.getElementById("autoSpinBtn");
const spinBtn=document.getElementById("spinBtn");
const toggleFreeSpinBtn=document.getElementById("toggleFreeSpin");
const freeSpinDisplay=document.getElementById("freeSpinDisplay");

// Setup reels
for(let c=0;c<cols;c++){
  const reel=document.createElement("div");
  reel.className="reel";
  const inner=document.createElement("div");
  for(let i=0;i<rows*15;i++){
    const cell=document.createElement("div");
    cell.className="cell";
    cell.textContent=symbols[Math.floor(Math.random()*symbols.length)];
    inner.appendChild(cell);
  }
  reel.appendChild(inner);
  slot.appendChild(reel);
  reels.push(inner);
}

function unlockAudio(){
  if(audioUnlocked) return;
  spinSound.play().then(()=>{ spinSound.pause(); spinSound.currentTime=0; audioUnlocked=true; }).catch(()=>{});
}
function startSpinSound(){
  if(audioUnlocked){
    spinSound.currentTime=0;
    spinSound.play();
    setTimeout(()=>{ spinSound.pause(); spinSound.currentTime=0; }, SPIN_DURATION);
  }
}
function stopSpinSound(){ spinSound.pause(); spinSound.currentTime=0; }

function setBet(v){
  bet=v;
  betButtons.forEach(b=>b.classList.remove("active"));
  [...betButtons].find(b=>{ if(b.textContent.replace("k","000")==v.toString()){ b.classList.add("active"); return true; }});  
}

function toggleFreeSpin(){
  if(isAutoSpinning) return;
  useFreeSpin = !useFreeSpin;
  toggleFreeSpinBtn.classList.toggle("active", useFreeSpin);
  toggleFreeSpinBtn.textContent = useFreeSpin ? "ON" : "OFF";
}

function cycleAutoSpin(){
  if(autoSpinBtn.classList.contains("disabled")) return;
  autoSpinIndex=(autoSpinIndex+1)%autoSpinModes.length;
  autoSpinBtn.textContent="x"+autoSpinModes[autoSpinIndex];
}

function spinAuto(){
  unlockAudio();
  if(isAutoSpinning) return;
  toggleFreeSpinBtn.disabled = true;
  toggleFreeSpinBtn.style.opacity = 0.5;

  let spins = autoSpinModes[autoSpinIndex];
  if(balance < bet*spins && (!useFreeSpin || freeSpins === 0)){
    highlightBalance();
    toggleFreeSpinBtn.disabled = false;
    toggleFreeSpinBtn.style.opacity = 1;
    return;
  }

  isAutoSpinning = true;
  spinBtn.classList.add("disabled"); spinBtn.style.background="red";
  autoSpinBtn.classList.add("disabled");

  let count = spins;
  function spinLoop(){
    if(count>0){
      count--;
      highlightReelsGlow();
      spin();
      setTimeout(spinLoop, SPIN_DURATION + 100);
    } else {
      isAutoSpinning = false;
      spinBtn.classList.remove("disabled"); spinBtn.style.background="gold";
      autoSpinBtn.classList.remove("disabled");
      toggleFreeSpinBtn.disabled = false;
      toggleFreeSpinBtn.style.opacity = 1;
      autoSpinBtn.textContent="x"+autoSpinModes[autoSpinIndex];
      clearReelGlow();
    }
  }
  spinLoop();
}

function highlightReelsGlow(){
  reels.forEach((reel,i)=>{
    setTimeout(()=>{ reel.parentElement.classList.add("hover"); },i*80);
    setTimeout(()=>{ reel.parentElement.classList.remove("hover"); },i*50+200);
  });
}
function clearReelGlow(){ reels.forEach(r=>r.parentElement.classList.remove("hover")); }

function spin(){
  document.querySelectorAll(".row-highlight").forEach(el=>el.remove());
  if(useFreeSpin && freeSpins>0){ freeSpins--; updateFreeSpinDisplay(); }
  else{ if(balance<bet){ highlightBalance(); return; } balance-=bet; updateBalance(); }
  generateSpinResult();
  reels.forEach((reel,i)=>{
    reel.style.transition=`transform ${SPIN_DURATION/1000}s ease-out`;
    stops[i]=Math.floor(Math.random()*(reel.children.length-rows));
    reel.style.transform=`translateY(-${stops[i]*cellH}px)`;
  });
  setTimeout(startSpinSound, 10);
  setTimeout(()=>{ stopSpinSound(); checkWin(SPIN_DURATION); }, SPIN_DURATION);
}

function generateSpinResult(){
  for(let r=0;r<rows;r++){
    for(let c=0;c<cols;c++){
      reels[c].children[stops[c]+r].textContent=symbols[Math.floor(Math.random()*symbols.length)];
    }
  }
}

function checkWin(duration){}
function showWinFloat(){}
function updateBalance(){ document.getElementById("balance").textContent="Rp "+balance.toLocaleString("id-ID"); }
function updateFreeSpinDisplay(){ freeSpinDisplay.textContent="Free Spins: "+freeSpins; }
function highlightBalance(){
  const b=document.getElementById("balance"); let c=0;
  const i=setInterval(()=>{ b.style.color=b.style.color==="red"?"":"red"; if(++c>=6){clearInterval(i);b.style.color="";}},50);
}
</script>
</body>
</html>
